---
layout: post
title: "XR to VESC: A Conversion Guide"
category: [DIY, Guides]
tags: [vesc, xr, diy, guide]
image: https://images.squarespace-cdn.com/content/v1/6360139198ee4b696834d610/bf3abd46-57e1-463e-97ed-2e649c841f11/header-image.jpg?format=2500w
description: Open-source is quickly moving from the future of onewheeling and into the present. Pro riders are beginning to adopt the <mark>VESC</mark> platform, which continues to evolve at a rapid pace. This year, we will see multiple open class races that will have no restrictions placed on the manufacturer of the boards that are ridden. The configurabilty, customization, and raw power are huge draw towards VESC, but because of it’s open-source and DIY nature, it remains inaccessible to many. There is currently a need for more clear documentation, so I’ve written this as a start-to-finish guide on how to get up and running on your own VESC based onewheel. This will include photos or screenshots for each step, as well as wiring diagrams. I plan on updating this guide over time, but that may prove impossible or futile as VESC evolves.
---

- [Introduction](#introduction)
  - [Project Goals](#project-goals)
  - [Standing on the Shoulders of Giants](#standing-on-the-shoulders-of-giants)
  - [Disclaimer \& Warnings](#disclaimer--warnings)
    - [A Warning About the BMS](#a-warning-about-the-bms)
    - [So, why re-use the BMS?](#so-why-re-use-the-bms)
    - [Mitigations and Accepted Risk](#mitigations-and-accepted-risk)
- [Prerequisites](#prerequisites)
  - [Knowledge](#knowledge)
  - [Hardware](#hardware)
  - [Smart Phone and Computer](#smart-phone-and-computer)
  - [Tools](#tools)
  - [Cost](#cost)
- [Hardware Setup](#hardware-setup)
  - [Wiring Diagrams](#wiring-diagrams)
  - [Installation](#installation)
- [Glossary](#glossary)

> Any time you see a <mark>highlighted</mark> term, it can be found in the [glossary](#glossary) at the end of this guide.
> {: .prompt-info }

## Introduction

Open-source is quickly moving from the future of onewheeling and into the present. Pro riders are beginning to adopt the <mark>VESC</mark> platform, which continues to evolve at a rapid pace. This year, we will see multiple open class races that will have no restrictions placed on the manufacturer of the boards that are ridden. The configurabilty, customization, and raw power are huge draw towards VESC, but because of it’s open-source and DIY nature, it remains inaccessible to many. There is currently a need for more clear documentation, so I’ve written this as a start-to-finish guide on how to get up and running on your own VESC based onewheel. This will include photos or screenshots for each step, as well as wiring diagrams. I plan on updating this guide over time, but that may prove impossible or futile as VESC evolves.

If you think I should’ve done something differently or you have a suggestion, keep it to yourself.

Just kidding! Shoot me an email with any questions or suggestions: tk@spinningmag.net

Or find me on Instragram: @tkgarrett

### Project Goals

The aim of this guide is to convert a Onewheel+ XR to use an open-sourced VESC based controller mounted in a 3D printed controller box. All other Future Motion components will be re-used, including the stock <mark>BMS</mark>, battery, and <mark>wiring harness</mark>. If at any time after the conversion you want to switch back, it will be as simple as reinstalling and connecting the old Future Motion controller module. This guide will also cover the initial VESC software setup, configuration, and some common troubleshooting steps. By the end of this project, you’ll have not only a working board, but the knowledge to continue exploring the world of DIY PEVs and electronics. If all of your ducks are in a row, you can easily complete this in a weekend. After doing a few myself, XR to VESC conversions only take me a few hours.

### Standing on the Shoulders of Giants

When I built my first board, I didn’t know very much at all about electronics, battery safety, or <mark>PID tuning</mark>. Where relevant, I’ll include links to other content creators that are way smarter than me. But, to say thanks, here is a short list of VESC onewheel titans that should definitely be at the top of this guide:

- [Mitch Lustig](https://www.instagram.com/nurxg/) - Creator of the VESC balance app, without which none of this would have been possible.
- [Surfdado](https://www.youtube.com/channel/UClhp0J195HBXm6p6KN8nE4Q) - Developer of Adaptive Terrain Response (ATR), the Float Control app, and many other balance app refinements.
- [Nico Aleman](https://www.youtube.com/@nicoaleman) - Developer of the VESC Float package, which is heavily based on surfdado’s work.
- The communities on [pev.dev](https://pev.dev/), [Discord](https://discord.gg/pdqXQy9TPN), and [Facebook](https://www.facebook.com/groups/vescbuilders) that patiently answer all of our dumb questions.

### Disclaimer & Warnings

<mark class='yellow'>It should go without saying, but riding a one-wheeled electronic balance board is dangerous. And riding a DIY, self-built onewheel? Even more so.</mark> If you miswire something, you could start a fire or fry your hardware. If you misconfigure something on your board, it could result in a crash involving cuts, scrapes, bruises, broken bones, or possibly even death. The procedures outlined in this guide aren’t difficult, but they require patience and attention to detail.

#### A Warning About the BMS

This particular hardware configuration re-uses the Future Motion BMS. The BMS has the ability to cut power to the board to protect the battery and in certain situations, this could happen without warning. These situations are mostly caused by hardware failure or austere conditions, such as:

- A bad cell in the battery
- Extreme cold weather
- A damaged wiring harness

#### So, why re-use the BMS?

The BMS provides the critical function of keeping your battery cells balanced. If your battery cells are unbalanced, your battery could overcharge and catch fire while charging. There are a couple of other added benefits. They are:

- If the board sits idle for ~20 minutes, it will turn off automatically. This prevents the battery from draining.
- The Future Motion controller module is still 100% compatible with the rest of the board. If for any reason you ever want to swap back, you can.

#### Mitigations and Accepted Risk

There are some ways to mitigate the risks associated with this setup:

1. Don’t ride in freezing weather. Lithium batteries are dangerous below freezing, so the BMS can cut power if the battery gets too cold.
2. Install an OWIE chip to monitor the battery cells manually. I will cover this with my own guide at a later time, but if you are interested in it now, [check out this conversation on pev.dev](https://pev.dev/t/owie-wiring-fw-use-fm-bms-for-15s-vexr/336).
3. Check your wiring harness and other components regularly for damage.
4. Always wear a helmet and other safety gear.

These mitigations don’t completely solve the problems associated with running the stock BMS. <mark class='yellow'>At the end of the day, you will need to decide if you accept the risk that at some point your board could shut off while you are riding it.</mark> But even completely stock XRs, GTs, and Pints have been reported to cut off during operation, so this risk is probably one you’ve already accepted. I don’t mean to dissuade anyone from building a VESC onewheel, but if these sound like risks that you don’t want to take on, this may not be the project for you. Proceed at your own risk.

***

## Prerequisites

I’ve included purchase links to most hardware or tools you will need. Where appropriate, I’ve included affiliate links, which will earn me a small commission.

### Knowledge

To successfully complete this conversion, you should have the following pre-requisite knowledge or at least be willing to learn:

- **How to disassemble and reassemble your Onewheel+ XR** - I’d recommend watching this video from 1wheelParts.

  - [https://youtu.be/0K2gZJivRfI](https://youtu.be/0K2gZJivRfI)

- **How to use a multimeter** - To check polarity, voltage, and continuity of your battery.

  - [https://youtu.be/TdUK6RPdIrA](https://youtu.be/TdUK6RPdIrA)

- **How to solder wires and connectors** - We will need to solder in the power button and charging port so that they are compatible with the Future Motion BMS.

  - [https://youtu.be/Zu3TYBs65FM](https://youtu.be/Zu3TYBs65FM)
  - [https://youtu.be/CnGq4Pcthr4](https://youtu.be/CnGq4Pcthr4)

- **How to install heat set inserts** - These are the brass inserts that will be pressed into the controller box. Read about them below.
  - [https://www.cnckitchen.com/blog/tipps-amp-tricks-fr-gewindeeinstze-im-3d-druck-3awey](https://www.cnckitchen.com/blog/tipps-amp-tricks-fr-gewindeeinstze-im-3d-druck-3awey)

### Hardware

Before beginning, be sure to have on hand:

- **Onewheel+ XR with a working BMS** - Hardware version and firmware version are irrelevant, it just needs to be an XR. Aftermarket accessories such as footpads, bumpers, rails, and tires will have little relevancy in this guide, so those should be fine. If you have an upgraded battery, such as a CBXR or a JWXR, this is also acceptable and will be addressed during the software setup. **_Your Onewheel should still have a working BMS_**_. If your goal is to bypass the BMS,_ **_this is not recommended_** _and this is not the guide for you._
- **Little FOCer VESC and connector kit** - This is the VESC controller and most of the necessary bits and bobs to make it compatible with your current Onewheel.

  - North America - [Flowglider DIY Bundle](https://www.makerspev.com/products/flowglider-diy-bundle) from MakersPEV.
  - Europe - [Little FOCer V3.1 VESC 84V 20S Complete Kit](https://customwheel.shop/high-voltage-vesc-motor-speed-controllers/little-focer-v31-esc-84v-20s-kit) from CustomWheel.

- **Power button** - The Future Motion BMS isn’t compatible with the latching button that comes with the DIY bundle, so we need purchase this separately. This is the one I used for my build.

  - [APIELE 19mm Momentary Push Button Switch](https://amzn.to/3IAQ8bh)

- **Controller enclosure**  - 3D printed Flowglider box. I print my own now, but I’ve had good experience with Phillip at Lit Timber. Get the PA6-CF (nylon with carbon fiber) version if you’re worried about heat resistance. PLA can melt or warp in a hot car.

  - [https://www.littimber.com/product/wtfoc-mk2-controller-box-for-little-focer-v3/](https://www.littimber.com/product/wtfoc-mk2-controller-box-for-little-focer-v3/)

- **Controller enclosure lid** - Lit Timber carries this sometimes as well. But its the same product. Choose the regular version, not the lid mount.

  - [https://plasticspider.com/controller-lid-and-gaskets-wtfoc-mk2-for-little-focer-v3-0-3-1/](https://plasticspider.com/controller-lid-and-gaskets-wtfoc-mk2-for-little-focer-v3-0-3-1/)

### Smart Phone and Computer

- **iPhone or Android mobile phone -** to facilitate the Bluetooth connection from your VESC to your desktop/laptop
- **Desktop or laptop computer (Windows, Mac, or Linux) -** to perform the initial setup and calibration

**Note:** Due to a bug with the iPhone version of <mark>VESC Tool</mark>, I am only including desktop/laptop documentation at this time. However, if you only have an Android device and still wish to convert your board following this guide, it is definitely possible. The interface on mobile is laid out differently than the desktop version, but all of the necessary menus are present. The iPhone bug affects the <mark>VESC Packages</mark> section of the app, which is necessary to complete the setup. You will still need a mobile device so your desktop can to connect to your VESC through Bluetooth and either an iPhone or Android may be used for that. You just can’t use the iPhone for the full setup without a desktop computer as well.

![Tools](https://images.squarespace-cdn.com/content/v1/6360139198ee4b696834d610/4c18a167-2325-4df8-a2dc-f073636f653d/vesc-conversion-tools.jpg?format=1500w)

### Tools

You probably have most of these tools already, but I’ve included some Amazon links just in case. Please note, unless they are marked with an asterisk (*), I haven’t personally used these tools.

TODO: Remove affiliate links and replace with normal links

- [**1/8 and 1/4 Hex Wrenches**](https://amzn.to/3YbZiAV)
- [**Screwdrivers**](https://amzn.to/3IFcM2m) (#1 Phillips, #2 Phillips, Flat Head)
- [**Needle Nose Pliers**](https://amzn.to/3KMPCtr)
- [**Adjustable Wrench**](https://amzn.to/3Yg2oUq)
- [**Wire Nippers**](https://amzn.to/3IIFuzv) *
- [**Wire Strippers**](https://amzn.to/3y4vJGG) *
- [**Multimeter**](https://amzn.to/3IIFuzv) *
- [**Heat Shrink**](https://amzn.to/3IxFVfO)

**Soldering Iron Kit** (including solder, flux, and helping hands)
- [**Soldering Iron**](https://amzn.to/3ZhPuXy) *
- [**Solder**](https://amzn.to/3SGrlqV) * (the spool of solder that comes with the kit above is terrible)
- [**Flux**](https://amzn.to/3Zx6ybu) * (the flux paste that comes with the kit is fine, but I love this liquid stuff)
- [**Tip Cleaner**](https://amzn.to/3YftJpI) *
- [**Heat Set Insert Tips**](https://amzn.to/3ZhQJGc) *

- [**Blue Threadlocker**](https://amzn.to/3y4F5m2) *
- [**20 Gauge Silicone Wire**](https://amzn.to/3ZsJSt0)

**Optional**
- [**Adhesive Backed Fishpaper**](https://amzn.to/3IGMFbf) * - Insulative material to help prevent electrical shorts.
- [**Extra Thermal Pads**](https://amzn.to/3SFxXpp) * - When you eventually need to take your controller apart to fix/change something, these will be good to have on hand. I always have at least one on hand.
- [**Zip Ties**](https://amzn.to/3ZsAUvR) - Good for cable management.
- [**Hot Glue Gun**](https://amzn.to/3EIT58M) - To keep the controller and wires in place during assembly.
- [**Flowglider Connector Cover**](https://www.littimber.com/product/wtfoc-mk2-connector-cover/) * - You can reuse the XR connector cover, but this one is way better.
- [**Heat gun**](https://amzn.to/3Zd5LwC) * - Used to shrink the heat shrink. You can use a lighter, but a heat gun is MUCH easier. There are cheaper versions, but this one has variable temperature and works great for me.
- [**Helping Hands**](https://amzn.to/3meemAE) * - To hold your wires and connectors in place while you solder.
- [**JST Connector Kit**](https://amzn.to/3J54LFp) * - This is great to have on hand in case you accidentally break a connector included in the DIY bundle.

\* Products that I personally use and recommend

And if you wanted to replicate my build entirely, you’ll need a few more things:
- [**BANG Bumpers**](https://thefloatlife.com/collections/shop-for-onewheel-xr/products/b-a-n-g-bumpers-gloss-finish?aff=7)
- [**Growler Varial Rails**](https://thefloatlife.com/products/varials?aff=7&variant=42533299126494)
- [**HellaRad Pint Tire**](https://thefloatlife.com/products/tfl-street-tire-pint-pint-x-compatible?_pos=2&_sid=290be33f5&_ss=r&aff=7)
- [**Float Life Savers Rim Guards**](https://thefloatlife.com/products/life-savers?aff=7&variant=43694011187422)
- [**Kush Lo Footpad w/ Street Grip**](https://thefloatlife.com/collections/shop-for-onewheel-xr/products/kush-lo-footpad-for-onewheel-v1-plus-xr?aff=7)

### Cost

The cost of this project will greatly depend on what parts you already have, but here is an estimation of the very basics. (You never include new tools in the project cost 🤣)

| Item                                | Price            | Notes                                                                      |
|-------------------------------------|------------------|----------------------------------------------------------------------------|
| Onewheel+ XR                        | $1,250.00        | A used XR will run you around $1000 - $1500 if you don't already have one. |
| Little FOCer VESC and connector kit | $430.00          |                                                                            |
| Power button                        | $11.49           |                                                                            |
| Controller enclosure                | $99.00           | PA6-CF version                                                             |
| Controller enclosure lid            | $45.00           |                                                                            |
| **Total**                           | **$1,835.49**    |                                                                            |

***

## Hardware Setup

Alright, now that you have a pile of parts and some shiny new tools, let’s dive in to the build. I’m consolidating information from a couple of different sources, which are listed at the bottom of the Hardware Setup section.

### Wiring Diagrams

<div class="gallery">
  <figure>
    <img src="https://images.squarespace-cdn.com/content/v1/6360139198ee4b696834d610/1677729407249-S4U7A1QYOIR1OZ4680DL/Little+FOCer+Cable+Routing.png?format=1000w" alt="Footpad and hall sensor">
  </figure>
  <figure>
    <img src="https://images.squarespace-cdn.com/content/v1/6360139198ee4b696834d610/1677721762331-DHJQFB5SWTS3RT8MWW3U/Momentary+Switch+Wiring+Diagram.png?format=1000w" alt="Installed in the Flowglider box">
  </figure>
</div>

Pictured above is the wiring diagram that we will be replicating. It is a modified version of [sav0](https://pev.dev/u/sav0)’s diagram from [their post on pev.dev](https://pev.dev/t/lfoc3-1-wiring-diagram-w-bms-options-chargeonly-bypass/502). It has been modified to include the purple wire, which will allow the board to turn on when connected to a charger and will also enable cell balancing. There are many different ways to configure the hardware in a VESC build. I’ve opted for this version because it doesn’t break compatibility with the stock Future Motion controller and it allows the BMS to balance the battery cells. If, at any time, you want to un-VESC your onewheel, you will simply need to re-install the original controller module.

### Installation

Let’s finally put some stuff in the controller box and get it installed. In some of the photos, a grey controller box was used. I ended up swapping over to a black PA6-CF box after my old grey ASA box broke. I tried to capture all of the necessary photos from the swap, but I missed a few.

**1. Install the footpad and hall sensor Switchcraft connectors.**

<div class="gallery">
  <figure>
    <img src="https://images.squarespace-cdn.com/content/v1/6360139198ee4b696834d610/1677702736601-BUYSVRRYEYB405OEP8PF/footpad-hall-sensor-connectos-3.jpg?format=1000w" alt="Footpad and hall sensor">
    <figcaption>Footpad (left) and hall sensor (right)</figcaption>
  </figure>
  <figure>
    <img src="https://images.squarespace-cdn.com/content/v1/6360139198ee4b696834d610/1677700761050-8HO1GUYB6D0GD1AUGXEI/footpad-hall-sensor-connectors.jpg?format=2500w" alt="Installed in the Flowglider box">
    <figcaption>Installed in the Flowglider box</figcaption>
  </figure>
  <figure>
    <img src="https://images.squarespace-cdn.com/content/v1/6360139198ee4b696834d610/1677700760708-EZ2CNQPCQXUV2IJWJR09/footpad-hall-sensor-connectors-2.jpg?format=2500w" alt="Installed in the Flowglider box">
    <figcaption>Installed in the Flowglider box</figcaption>
  </figure>
</div>

<mark>Switchcraft</mark> is in the glossary

a. Install the 3-wire footpad connector on the left and the 5-wire <mark>hall sensor</mark> connector on the right to mimic Future Motion’s configuration. Or, swap the connectors so that the hall sensor is closer to the motor power connector, which I think makes more sense.

b. Make sure to install the gaskets on the inside of the box.

c. Snug down the plastic retainer nuts using an adjustable wrench. Be careful not to over-tighten! Plastic threads are easily stripped.

**TIPS**

- You may need to use a rasp, file, or small knife to widen the hole before inserting your connector because 3D printer accuracy will vary.
- Install small zip ties to help with cable management. Be sure to trim down the zip ties so that they are flush with the head. You don’t want any sharp edges exposed that could cut the other wires inside the box.


***

## Glossary

AWG
: American Wire Gauge. Shorthand notation when writing about wire gauges.

BMS
: Battery Management System. It’s the circuit board that is connected directly to your battery pack. It’s responsible for maintaining the health of your battery, which it does by balancing the voltage - or charge level - of the individual cells of the battery pack. The voltage of the individual cells will drift apart over time if they are not managed. This will eventually lead to a battery fire while charging. That is why we DO NOT RECOMMEND running a onewheel without a BMS. When the BMS is connected to the stock Future Motion controller, it also does other things like monitor battery temperature levels and manage battery discharge.

Connector Types
: JST, Molex (3 pin white, 6 pin black, and 16 pin black), Switchcraft, XLR, XT60
<div class="gallery">
  <figure>
    <img src="https://images.squarespace-cdn.com/content/v1/6360139198ee4b696834d610/1677875182786-36MV1GS6ZNPH62KFH6TO/jst-3pin.png?format=2500w" alt="JST 3-pin">
    <figcaption>JST 3-pin</figcaption>
  </figure>
  <figure>
    <img src="https://images.squarespace-cdn.com/content/v1/6360139198ee4b696834d610/1677875182825-KC8QGXF26CY61YNGNKX8/jst-6pin.png?format=2500w" alt="JST 6-pin">
    <figcaption>JST 6-pin</figcaption>
  </figure>
  <figure>
    <img src="https://images.squarespace-cdn.com/content/v1/6360139198ee4b696834d610/1677875185510-148K5FUT8E2Y1VB74RP1/molex-white-3pin.png?format=2500w" alt="White Molex">
    <figcaption>White Molex</figcaption>
  </figure>
  <figure>
    <img src="https://images.squarespace-cdn.com/content/v1/6360139198ee4b696834d610/1677875184480-51WBU236JS02S61MWA36/molex-6pin.png?format=2500w" alt="Molex 6-pin">
    <figcaption>Molex 6-pin</figcaption>
  </figure>
  <figure>
    <img src="https://images.squarespace-cdn.com/content/v1/6360139198ee4b696834d610/1677875184531-FAIV7KUYQBMJCOZSOM3C/molex-16pin.png?format=2500w" alt="Molex 16-pin">
    <figcaption>Molex 16-pin</figcaption>
  </figure>
  <figure>
    <img src="https://images.squarespace-cdn.com/content/v1/6360139198ee4b696834d610/1677875185650-SO3986DOMY9FKEERQSQP/switchcraft.png?format=2500w" alt="Switchcraft">
    <figcaption>Switchcraft</figcaption>
  </figure>
  <figure>
    <img src="https://images.squarespace-cdn.com/content/v1/6360139198ee4b696834d610/1677875186506-AQUZZ506EDL7M1CL4S2Q/xlr.png?format=2500w" alt="XLR">
    <figcaption>XLR</figcaption>
  </figure>
  <figure>
    <img src="https://images.squarespace-cdn.com/content/v1/6360139198ee4b696834d610/1677875271598-OPDMQV3AZ4CDUT0BNYJS/xt60.png?format=2500w" alt="XT60">
    <figcaption>XT60</figcaption>
  </figure>
</div>

Hall Sensors
: Within the hub, the hall effect sensors detect the position of the magnets and allow the VESC to know when and how much power to send to the motor.

IMU
: Inertial Measurement Unit. Uses accelerometers and gyroscopes to detect the angle of the board. The VESC balance app uses this data to know how to adjust the amount of power it needs to send to the hub motor in order to keep the onewheel balanced.

PID
: PID stands for “proportional–integral–derivative”. This is a type of software control loop that continuously takes feedback and adjusts the system it is controlling. In our case, the PID loop takes the input of the rider on the board and spins the wheel so that you stay upright. [PID loops are explained in this video](https://www.youtube.com/watch?v=JFTJ2SS4xyA) in a way that I can almost understand.

Roll, Pitch, and Yaw
: The three dimensions of rotation detected by the IMU.

<div class="gallery">
  <figure>
    <img src="../../assets/img/posts/xr-to-vesc/pitch-roll-yaw-album/pitch.jpg" alt="Pitch">
  </figure>
  <figure>
    <img src="../../assets/img/posts/xr-to-vesc/pitch-roll-yaw-album/roll.jpg" alt="Roll">
  </figure>
  <figure>
    <img src="../../assets/img/posts/xr-to-vesc/pitch-roll-yaw-album/yaw.jpg" alt="Yaw">
  </figure>
</div>

VESC
: Vedder Electronic Speed Controller. Electronic Speed Controllers (ESC) are used in everything from drones to e-skates. VESC is an open-sourced ESC developed and trademarked by Benjamin Vedder. In the context of this project, we will be replacing the proprietary Future Motion ESC with a Little FOCer, which is a type of VESC. Read more at [vesc-project.com](https://vesc-project.com/).

VESC Packages
: A feature that was added in VESC firmware version 6.0. The packages feature allows developers to extend the functionality of the VESC firmware without having to modify the firmware itself. For VESC onewheels, we are most interested in the Float package.

VESC Tool
: VESC Tool is the open-source companion application for the VESC platform. Update firmware, change settings, check battery and other stats, all from the app. Available on iOS, Android, Mac, Windows, and Linux.

Wiring Harness
: A wiring harness is a generic term for a bundle that contains multiple wires in bound together and typically wrapped in some sort of protective shroud. In the context of this guide, I’ll usually be referring to the wiring harness that is attached to the battery module and connects to the controller module using a 16 pin Molex.
